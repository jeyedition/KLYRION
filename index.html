<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KLYRION</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<!-- SPLASH -->
<div id="splash">
  <img src="logo.svg">
</div>

<!-- HEADER -->
<header>
  <h1>KLYRION</h1>
  <input id="search" placeholder="Buscar..." oninput="filter()">
</header>

<!-- CONTENIDO -->
<main id="content"></main>

<!-- NAVEGACIÓN -->
<nav>
  <button onclick="show('movies')">Películas</button>
  <button onclick="show('iptv')">IPTV</button>
</nav>

<!-- PLAYER -->
<div id="player">
  <video id="video" controls autoplay></video>
  <button onclick="closePlayer()">✖</button>
</div>

<script>
const DATA_URL = "data.json";
let DATA = {};
let CURRENT = [];

/* SPLASH */
setTimeout(()=>{
  document.getElementById("splash").style.display="none";
},2000);

/* CARGAR DATOS */
async function loadData(){
  const r = await fetch(DATA_URL);
  DATA = await r.json();
  show("movies");
}

/* MOSTRAR SECCIÓN */
function show(type){
  CURRENT = DATA[type];
  render(CURRENT);
}

/* RENDER */
function render(list){
  content.innerHTML="";
  list.forEach(item=>{
    const c = document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <img src="${item.img}">
      <span>▶ VER</span>
    `;
    c.onclick = ()=> play(item.url);
    content.appendChild(c);
  });
}

/* BUSCADOR */
function filter(){
  const q = search.value.toLowerCase();
  render(
    CURRENT.filter(i =>
      (i.title || "").toLowerCase().includes(q)
    )
  );
}

/* PLAYER */
function play(url){
  player.style.display="flex";
  video.src=url;
}
function closePlayer(){
  video.pause();
  video.src="";
  player.style.display="none";
}

loadData();
</script>

</body>
</html>
